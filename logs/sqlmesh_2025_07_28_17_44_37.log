2025-07-28 17:44:39,381 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0001_init.py'> (migrator.py:177)
2025-07-28 17:44:39,459 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0002_remove_identify.py'> (migrator.py:177)
2025-07-28 17:44:39,460 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0003_move_batch_size.py'> (migrator.py:177)
2025-07-28 17:44:39,465 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0004_environmnent_add_finalized_at.py'> (migrator.py:177)
2025-07-28 17:44:39,467 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0005_create_seed_table.py'> (migrator.py:177)
2025-07-28 17:44:39,488 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0006_change_seed_hash.py'> (migrator.py:177)
2025-07-28 17:44:39,488 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0007_env_table_info_to_kind.py'> (migrator.py:177)
2025-07-28 17:44:39,491 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0008_create_intervals_table.py'> (migrator.py:177)
2025-07-28 17:44:39,516 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0009_remove_pre_post_hooks.py'> (migrator.py:177)
2025-07-28 17:44:39,518 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0010_seed_hash_batch_size.py'> (migrator.py:177)
2025-07-28 17:44:39,518 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0011_add_model_kind_name.py'> (migrator.py:177)
2025-07-28 17:44:39,520 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0012_update_jinja_expressions.py'> (migrator.py:177)
2025-07-28 17:44:39,522 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0013_serde_using_model_dialects.py'> (migrator.py:177)
2025-07-28 17:44:39,524 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0014_fix_dev_intervals.py'> (migrator.py:177)
2025-07-28 17:44:39,526 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0015_environment_add_promoted_snapshot_ids.py'> (migrator.py:177)
2025-07-28 17:44:39,527 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0016_fix_windows_path.py'> (migrator.py:177)
2025-07-28 17:44:39,528 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0017_fix_windows_seed_path.py'> (migrator.py:177)
2025-07-28 17:44:39,530 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0018_rename_snapshot_model_to_node.py'> (migrator.py:177)
2025-07-28 17:44:39,531 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0019_add_env_suffix_target.py'> (migrator.py:177)
2025-07-28 17:44:39,533 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0020_remove_redundant_attributes_from_dbt_models.py'> (migrator.py:177)
2025-07-28 17:44:39,535 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0021_fix_table_properties.py'> (migrator.py:177)
2025-07-28 17:44:39,536 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0022_move_project_to_model.py'> (migrator.py:177)
2025-07-28 17:44:39,537 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0023_fix_added_models_with_forward_only_parents.py'> (migrator.py:177)
2025-07-28 17:44:39,538 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0024_replace_model_kind_name_enum_with_value.py'> (migrator.py:177)
2025-07-28 17:44:39,540 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0025_fix_intervals_and_missing_change_category.py'> (migrator.py:177)
2025-07-28 17:44:39,544 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0026_remove_dialect_from_seed.py'> (migrator.py:177)
2025-07-28 17:44:39,546 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0027_minute_interval_to_five.py'> (migrator.py:177)
2025-07-28 17:44:39,553 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0028_add_plan_dags_table.py'> (migrator.py:177)
2025-07-28 17:44:39,583 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0029_generate_schema_types_using_dialect.py'> (migrator.py:177)
2025-07-28 17:44:39,587 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0030_update_unrestorable_snapshots.py'> (migrator.py:177)
2025-07-28 17:44:39,592 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0031_remove_dbt_target_fields.py'> (migrator.py:177)
2025-07-28 17:44:39,595 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0032_add_sqlmesh_version.py'> (migrator.py:177)
2025-07-28 17:44:39,596 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0033_mysql_fix_blob_text_type.py'> (migrator.py:177)
2025-07-28 17:44:39,596 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0034_add_default_catalog.py'> (migrator.py:177)
2025-07-28 17:44:39,605 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0035_add_catalog_name_override.py'> (migrator.py:177)
2025-07-28 17:44:39,606 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0036_delete_plan_dags_bug_fix.py'> (migrator.py:177)
2025-07-28 17:44:39,608 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0037_remove_dbt_is_incremental_macro.py'> (migrator.py:177)
2025-07-28 17:44:39,610 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0038_add_expiration_ts_to_snapshot.py'> (migrator.py:177)
2025-07-28 17:44:39,614 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0039_include_environment_in_plan_dag_spec.py'> (migrator.py:177)
2025-07-28 17:44:39,615 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0040_add_previous_finalized_snapshots.py'> (migrator.py:177)
2025-07-28 17:44:39,617 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0041_remove_hash_raw_query_attribute.py'> (migrator.py:177)
2025-07-28 17:44:39,620 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0042_trim_indirect_versions.py'> (migrator.py:177)
2025-07-28 17:44:39,622 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (migrator.py:177)
2025-07-28 17:44:39,624 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0044_quote_identifiers_in_model_attributes.py'> (migrator.py:177)
2025-07-28 17:44:39,624 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0045_move_gateway_variable' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0045_move_gateway_variable.py'> (migrator.py:177)
2025-07-28 17:44:39,627 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0046_add_batch_concurrency' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0046_add_batch_concurrency.py'> (migrator.py:177)
2025-07-28 17:44:39,627 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0047_change_scd_string_to_column' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0047_change_scd_string_to_column.py'> (migrator.py:177)
2025-07-28 17:44:39,627 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0048_drop_indirect_versions' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0048_drop_indirect_versions.py'> (migrator.py:177)
2025-07-28 17:44:39,629 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0049_replace_identifier_with_version_in_seeds_table' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0049_replace_identifier_with_version_in_seeds_table.py'> (migrator.py:177)
2025-07-28 17:44:39,674 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0050_drop_seeds_table' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0050_drop_seeds_table.py'> (migrator.py:177)
2025-07-28 17:44:39,676 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0051_rename_column_descriptions' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0051_rename_column_descriptions.py'> (migrator.py:177)
2025-07-28 17:44:39,680 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0052_add_normalize_name_in_environment_naming_info' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0052_add_normalize_name_in_environment_naming_info.py'> (migrator.py:177)
2025-07-28 17:44:39,687 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0053_custom_model_kind_extra_attributes' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0053_custom_model_kind_extra_attributes.py'> (migrator.py:177)
2025-07-28 17:44:39,688 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0054_fix_trailing_comments' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0054_fix_trailing_comments.py'> (migrator.py:177)
2025-07-28 17:44:39,688 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0055_add_updated_ts_unpaused_ts_ttl_ms_unrestorable_to_snapshot' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0055_add_updated_ts_unpaused_ts_ttl_ms_unrestorable_to_snapshot.py'> (migrator.py:177)
2025-07-28 17:44:39,695 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0056_restore_table_indexes' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0056_restore_table_indexes.py'> (migrator.py:177)
2025-07-28 17:44:39,790 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0057_add_table_format' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0057_add_table_format.py'> (migrator.py:177)
2025-07-28 17:44:39,790 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0058_add_requirements' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0058_add_requirements.py'> (migrator.py:177)
2025-07-28 17:44:39,792 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0059_add_physical_version' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0059_add_physical_version.py'> (migrator.py:177)
2025-07-28 17:44:39,792 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0060_move_audits_to_model' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0060_move_audits_to_model.py'> (migrator.py:177)
2025-07-28 17:44:39,794 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0061_mysql_fix_blob_text_type.py'> (migrator.py:177)
2025-07-28 17:44:39,795 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0062_add_model_gateway.py'> (migrator.py:177)
2025-07-28 17:44:39,795 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0063_change_signals.py'> (migrator.py:177)
2025-07-28 17:44:39,796 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0064_join_when_matched_strings.py'> (migrator.py:177)
2025-07-28 17:44:39,798 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0065_add_model_optimize.py'> (migrator.py:177)
2025-07-28 17:44:39,798 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0066_add_auto_restatements.py'> (migrator.py:177)
2025-07-28 17:44:39,812 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0067_add_tsql_date_full_precision.py'> (migrator.py:177)
2025-07-28 17:44:39,812 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:177)
2025-07-28 17:44:39,812 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0069_update_dev_table_suffix.py'> (migrator.py:177)
2025-07-28 17:44:39,817 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0070_include_grains_in_metadata_hash.py'> (migrator.py:177)
2025-07-28 17:44:39,817 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0071_add_dev_version_to_intervals.py'> (migrator.py:177)
2025-07-28 17:44:39,822 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0072_add_environment_statements.py'> (migrator.py:177)
2025-07-28 17:44:39,839 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0073_remove_symbolic_disable_restatement.py'> (migrator.py:177)
2025-07-28 17:44:39,843 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0074_add_partition_by_time_column_property.py'> (migrator.py:177)
2025-07-28 17:44:39,843 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0075_remove_validate_query.py'> (migrator.py:177)
2025-07-28 17:44:39,847 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0076_add_cron_tz.py'> (migrator.py:177)
2025-07-28 17:44:39,847 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0077_fix_column_type_hash_calculation.py'> (migrator.py:177)
2025-07-28 17:44:39,847 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py'> (migrator.py:177)
2025-07-28 17:44:39,848 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0079_add_gateway_managed_property.py'> (migrator.py:177)
2025-07-28 17:44:39,852 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:177)
2025-07-28 17:44:39,852 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0081_update_partitioned_by.py'> (migrator.py:177)
2025-07-28 17:44:39,856 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:177)
2025-07-28 17:44:39,858 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from '/home/kanakgupta/.local/lib/python3.10/site-packages/sqlmesh/migrations/v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:177)
2025-07-28 17:44:39,861 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:196)
2025-07-28 17:44:39,862 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:213)
2025-07-28 17:44:39,865 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:206)
2025-07-28 17:44:51,403 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema postgres.sqlmesh__raw (evaluator.py:348)
2025-07-28 17:44:51,404 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema postgres.sqlmesh__enrich (evaluator.py:348)
2025-07-28 17:44:51,414 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2184)
2025-07-28 17:44:51,424 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2184)
2025-07-28 17:44:51,932 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.sqlmesh__enrich' (evaluator.py:1131)
2025-07-28 17:44:51,949 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "sqlmesh__enrich" (base.py:2184)
2025-07-28 17:44:51,954 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.sqlmesh__raw' (evaluator.py:1131)
2025-07-28 17:44:51,955 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "sqlmesh__raw" (base.py:2184)
2025-07-28 17:44:51,987 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__raw.raw__transactions__1169070496' (evaluator.py:1497)
2025-07-28 17:44:51,991 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__raw"."raw__transactions__1169070496" ("Unnamed: 0" BIGINT, "cust_id" BIGINT, "account_id" TEXT, "card_id" BIGINT, "transaction_id" TEXT, "transaction_amnt" BIGINT, "mode_of_payment" TEXT, "mcc_code" TEXT, "transaction_time_stamp" TEXT, "transaction_sign" TEXT, "transaction_type" TEXT, "swift_cd" DOUBLE PRECISION, "currency_cd" TEXT, "transaction_status" TEXT, "product_id" TEXT, "channel_id" TEXT, "count" BIGINT, "posting_date" TEXT, "value_date" TEXT, "notes" DOUBLE PRECISION, "reason_code" TEXT, "created_at" TEXT) (base.py:2184)
2025-07-28 17:44:52,004 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__raw.raw__customer__3869639198' (evaluator.py:1497)
2025-07-28 17:44:52,008 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__raw"."raw__customer__3869639198" ("Unnamed: 0" BIGINT, "cust_id" BIGINT, "cust_dob" TEXT, "cust_first_name" TEXT, "cust_middle_name" TEXT, "cust_last_name" TEXT, "cust_segment" TEXT, "cust_title" TEXT, "customer_category" TEXT, "customer_privelege" TEXT, "customer_type" TEXT, "email_addr" TEXT, "gender" TEXT, "minor_flag" TEXT, "mobile_number1" BIGINT, "marital_status" TEXT, "nationality" TEXT, "occupation" TEXT, "senior_citizen_flag" TEXT, "sourcing_channel" TEXT, "customer_status" TEXT, "customer_risk_category" TEXT, "afflunce_level" TEXT, "customer_addressline1" TEXT, "customer_addressline2" TEXT, "customer_addressline3" DOUBLE PRECISION, "city" TEXT, "state" TEXT, "country" TEXT, "pin" TEXT, "created_at" TEXT, "modified_at" TEXT, "cibil_check_date" TEXT, "cibil_score" BIGINT, "country_code" BIGINT) (base.py:2184)
2025-07-28 17:44:52,020 - ThreadPoolExecutor-2_2 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__raw.raw__account__3286186908' (evaluator.py:1497)
2025-07-28 17:44:52,024 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__raw"."raw__account__3286186908" ("Unnamed: 0" BIGINT, "account_id" TEXT, "account_number" BIGINT, "product_id" TEXT, "account_origination_date" TEXT, "current_balance" BIGINT, "avg_monthly_balance" DOUBLE PRECISION, "avg_qtr_balance" BIGINT, "primary_account_holder_id" BIGINT, "secondary_account_holder_id" DOUBLE PRECISION, "available_balance" DOUBLE PRECISION, "debit_card" DOUBLE PRECISION, "credit_card" BIGINT, "currency_code" TEXT, "account_status" TEXT, "source_channel" TEXT, "campaign_id" TEXT, "applied_interest_rate" DOUBLE PRECISION, "statement_date" TEXT, "mode_of_statement" TEXT, "statement_frequency" TEXT, "branch_id" BIGINT, "created_at" TEXT, "modified_at" TEXT) (base.py:2184)
2025-07-28 17:44:52,032 - ThreadPoolExecutor-2_3 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__raw.raw__product__3418704722' (evaluator.py:1497)
2025-07-28 17:44:52,034 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__raw"."raw__product__3418704722" ("Unnamed: 0" BIGINT, "key" TEXT, "type" TEXT, "name" TEXT, "currency_code" TEXT, "status" TEXT, "credit_interest_rate" DOUBLE PRECISION, "debit_interest_rate" DOUBLE PRECISION, "credit_line_amount" BIGINT, "created_at" TEXT, "modified_at" TEXT, "id" TEXT) (base.py:2184)
2025-07-28 17:44:52,072 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'raw__transactions__1169070496' AND "table_schema" = 'sqlmesh__raw' (base.py:2184)
2025-07-28 17:44:52,096 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'raw__account__3286186908' AND "table_schema" = 'sqlmesh__raw' (base.py:2184)
2025-07-28 17:44:52,107 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'raw__product__3418704722' AND "table_schema" = 'sqlmesh__raw' (base.py:2184)
2025-07-28 17:44:52,108 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__raw"."raw__transactions__1169070496" WHERE TRUE (base.py:2184)
2025-07-28 17:44:52,123 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'raw__customer__3869639198' AND "table_schema" = 'sqlmesh__raw' (base.py:2184)
2025-07-28 17:44:52,126 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__raw"."raw__account__3286186908" WHERE TRUE (base.py:2184)
2025-07-28 17:44:52,138 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__raw"."raw__account__3286186908" ("Unnamed: 0", "account_id", "account_number", "product_id", "account_origination_date", "current_balance", "avg_monthly_balance", "avg_qtr_balance", "primary_account_holder_id", "secondary_account_holder_id", "available_balance", "debit_card", "credit_card", "currency_code", "account_status", "source_channel", "campaign_id", "applied_interest_rate", "statement_date", "mode_of_statement", "statement_frequency", "branch_id", "created_at", "modified_at") SELECT CAST("Unnamed: 0" AS BIGINT) AS "Unnamed: 0", CAST("account_id" AS TEXT) AS "account_id", CAST("account_number" AS BIGINT) AS "account_number", CAST("product_id" AS TEXT) AS "product_id", CAST("account_origination_date" AS TEXT) AS "account_origination_date", CAST("current_balance" AS BIGINT) AS "current_balance", CAST("avg_monthly_balance" AS DOUBLE PRECISION) AS "avg_monthly_balance", CAST("avg_qtr_balance" AS BIGINT) AS "avg_qtr_balance", CAST("primary_account_holder_id" AS BIGINT) AS "primary_account_holder_id", CAST("secondary_account_holder_id" AS DOUBLE PRECISION) AS "secondary_account_holder_id", CAST("available_balance" AS DOUBLE PRECISION) AS "available_balance", CAST("debit_card" AS DOUBLE PRECISION) AS "debit_card", CAST("credit_card" AS BIGINT) AS "credit_card", CAST("currency_code" AS TEXT) AS "currency_code", CAST("account_status" AS TEXT) AS "account_status", CAST("source_channel" AS TEXT) AS "source_channel", CAST("campaign_id" AS TEXT) AS "campaign_id", CAST("applied_interest_rate" AS DOUBLE PRECISION) AS "applied_interest_rate", CAST("statement_date" AS TEXT) AS "statement_date", CAST("mode_of_statement" AS TEXT) AS "mode_of_statement", CAST("statement_frequency" AS TEXT) AS "statement_frequency", CAST("branch_id" AS BIGINT) AS "branch_id", CAST("created_at" AS TEXT) AS "created_at", CAST("modified_at" AS TEXT) AS "modified_at" FROM (VALUES "<REDACTED VALUES>") AS "t"("Unnamed: 0", "account_id", "account_number", "product_id", "account_origination_date", "current_balance", "avg_monthly_balance", "avg_qtr_balance", "primary_account_holder_id", "secondary_account_holder_id", "available_balance", "debit_card", "credit_card", "currency_code", "account_status", "source_channel", "campaign_id", "applied_interest_rate", "statement_date", "mode_of_statement", "statement_frequency", "branch_id", "created_at", "modified_at") (base.py:2184)
2025-07-28 17:44:52,141 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__raw"."raw__product__3418704722" WHERE TRUE (base.py:2184)
2025-07-28 17:44:52,168 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__raw"."raw__transactions__1169070496" ("Unnamed: 0", "cust_id", "account_id", "card_id", "transaction_id", "transaction_amnt", "mode_of_payment", "mcc_code", "transaction_time_stamp", "transaction_sign", "transaction_type", "swift_cd", "currency_cd", "transaction_status", "product_id", "channel_id", "count", "posting_date", "value_date", "notes", "reason_code", "created_at") SELECT CAST("Unnamed: 0" AS BIGINT) AS "Unnamed: 0", CAST("cust_id" AS BIGINT) AS "cust_id", CAST("account_id" AS TEXT) AS "account_id", CAST("card_id" AS BIGINT) AS "card_id", CAST("transaction_id" AS TEXT) AS "transaction_id", CAST("transaction_amnt" AS BIGINT) AS "transaction_amnt", CAST("mode_of_payment" AS TEXT) AS "mode_of_payment", CAST("mcc_code" AS TEXT) AS "mcc_code", CAST("transaction_time_stamp" AS TEXT) AS "transaction_time_stamp", CAST("transaction_sign" AS TEXT) AS "transaction_sign", CAST("transaction_type" AS TEXT) AS "transaction_type", CAST("swift_cd" AS DOUBLE PRECISION) AS "swift_cd", CAST("currency_cd" AS TEXT) AS "currency_cd", CAST("transaction_status" AS TEXT) AS "transaction_status", CAST("product_id" AS TEXT) AS "product_id", CAST("channel_id" AS TEXT) AS "channel_id", CAST("count" AS BIGINT) AS "count", CAST("posting_date" AS TEXT) AS "posting_date", CAST("value_date" AS TEXT) AS "value_date", CAST("notes" AS DOUBLE PRECISION) AS "notes", CAST("reason_code" AS TEXT) AS "reason_code", CAST("created_at" AS TEXT) AS "created_at" FROM (VALUES "<REDACTED VALUES>") AS "t"("Unnamed: 0", "cust_id", "account_id", "card_id", "transaction_id", "transaction_amnt", "mode_of_payment", "mcc_code", "transaction_time_stamp", "transaction_sign", "transaction_type", "swift_cd", "currency_cd", "transaction_status", "product_id", "channel_id", "count", "posting_date", "value_date", "notes", "reason_code", "created_at") (base.py:2184)
2025-07-28 17:44:52,191 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__raw"."raw__product__3418704722" ("Unnamed: 0", "key", "type", "name", "currency_code", "status", "credit_interest_rate", "debit_interest_rate", "credit_line_amount", "created_at", "modified_at", "id") SELECT CAST("Unnamed: 0" AS BIGINT) AS "Unnamed: 0", CAST("key" AS TEXT) AS "key", CAST("type" AS TEXT) AS "type", CAST("name" AS TEXT) AS "name", CAST("currency_code" AS TEXT) AS "currency_code", CAST("status" AS TEXT) AS "status", CAST("credit_interest_rate" AS DOUBLE PRECISION) AS "credit_interest_rate", CAST("debit_interest_rate" AS DOUBLE PRECISION) AS "debit_interest_rate", CAST("credit_line_amount" AS BIGINT) AS "credit_line_amount", CAST("created_at" AS TEXT) AS "created_at", CAST("modified_at" AS TEXT) AS "modified_at", CAST("id" AS TEXT) AS "id" FROM (VALUES "<REDACTED VALUES>") AS "t"("Unnamed: 0", "key", "type", "name", "currency_code", "status", "credit_interest_rate", "debit_interest_rate", "credit_line_amount", "created_at", "modified_at", "id") (base.py:2184)
2025-07-28 17:44:52,206 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__enrich.enrich__transactions__711840502' (evaluator.py:1497)
2025-07-28 17:44:52,209 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__enrich"."enrich__transactions__711840502" ("Unnamed: 0" BIGINT, "cust_id" BIGINT, "account_id" TEXT, "card_id" BIGINT, "transaction_id" TEXT, "transaction_amnt" BIGINT, "mode_of_payment" TEXT, "mcc_code" TEXT, "transaction_time_stamp" TEXT, "transaction_sign" TEXT, "transaction_type" TEXT, "swift_cd" DOUBLE PRECISION, "currency_cd" TEXT, "transaction_status" TEXT, "product_id" TEXT, "channel_id" TEXT, "count" BIGINT, "posting_date" TEXT, "value_date" TEXT, "notes" DOUBLE PRECISION, "reason_code" TEXT, "created_at" TEXT) (base.py:2184)
2025-07-28 17:44:52,220 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'enrich.transactions' (evaluator.py:1519)
2025-07-28 17:44:52,222 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__raw"."raw__customer__3869639198" WHERE TRUE (base.py:2184)
2025-07-28 17:44:52,224 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "transactions"."Unnamed: 0" AS "Unnamed: 0", "transactions"."cust_id" AS "cust_id", "transactions"."account_id" AS "account_id", "transactions"."card_id" AS "card_id", "transactions"."transaction_id" AS "transaction_id", "transactions"."transaction_amnt" AS "transaction_amnt", "transactions"."mode_of_payment" AS "mode_of_payment", "transactions"."mcc_code" AS "mcc_code", "transactions"."transaction_time_stamp" AS "transaction_time_stamp", "transactions"."transaction_sign" AS "transaction_sign", "transactions"."transaction_type" AS "transaction_type", "transactions"."swift_cd" AS "swift_cd", "transactions"."currency_cd" AS "currency_cd", "transactions"."transaction_status" AS "transaction_status", "transactions"."product_id" AS "product_id", "transactions"."channel_id" AS "channel_id", "transactions"."count" AS "count", "transactions"."posting_date" AS "posting_date", "transactions"."value_date" AS "value_date", "transactions"."notes" AS "notes", "transactions"."reason_code" AS "reason_code", "transactions"."created_at" AS "created_at" FROM "postgres"."sqlmesh__raw"."raw__transactions__1169070496" AS "transactions" WHERE FALSE LIMIT 0 (base.py:2184)
2025-07-28 17:44:52,240 - ThreadPoolExecutor-2_2 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__enrich.enrich__account__2754391612' (evaluator.py:1497)
2025-07-28 17:44:52,280 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__enrich"."enrich__account__2754391612" ("account_id" TEXT, "account_number" BIGINT, "product_id" TEXT, "opening_date" TEXT, "current_balance" BIGINT, "avg_monthly_balance" DOUBLE PRECISION, "avg_qtr_balance" BIGINT, "cust_id" BIGINT, "available_balance" DOUBLE PRECISION, "credit_card" BIGINT, "debit_card" DOUBLE PRECISION, "currency_code" TEXT, "account_status" TEXT, "source_channel" TEXT, "campaign_id" TEXT, "applied_interest_rate" DOUBLE PRECISION, "statement_date" TEXT, "mode_of_statement" TEXT) (base.py:2184)
2025-07-28 17:44:52,320 - ThreadPoolExecutor-2_2 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'enrich.account' (evaluator.py:1519)
2025-07-28 17:44:52,352 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "account"."account_id" AS "account_id", "account"."account_number" AS "account_number", "account"."product_id" AS "product_id", "account"."account_origination_date" AS "opening_date", "account"."current_balance" AS "current_balance", "account"."avg_monthly_balance" AS "avg_monthly_balance", "account"."avg_qtr_balance" AS "avg_qtr_balance", "account"."primary_account_holder_id" AS "cust_id", "account"."available_balance" AS "available_balance", "account"."credit_card" AS "credit_card", "account"."debit_card" AS "debit_card", "account"."currency_code" AS "currency_code", "account"."account_status" AS "account_status", "account"."source_channel" AS "source_channel", "account"."campaign_id" AS "campaign_id", "account"."applied_interest_rate" AS "applied_interest_rate", "account"."statement_date" AS "statement_date", "account"."mode_of_statement" AS "mode_of_statement" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" WHERE FALSE LIMIT 0 (base.py:2184)
2025-07-28 17:44:52,528 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__raw"."raw__customer__3869639198" ("Unnamed: 0", "cust_id", "cust_dob", "cust_first_name", "cust_middle_name", "cust_last_name", "cust_segment", "cust_title", "customer_category", "customer_privelege", "customer_type", "email_addr", "gender", "minor_flag", "mobile_number1", "marital_status", "nationality", "occupation", "senior_citizen_flag", "sourcing_channel", "customer_status", "customer_risk_category", "afflunce_level", "customer_addressline1", "customer_addressline2", "customer_addressline3", "city", "state", "country", "pin", "created_at", "modified_at", "cibil_check_date", "cibil_score", "country_code") SELECT CAST("Unnamed: 0" AS BIGINT) AS "Unnamed: 0", CAST("cust_id" AS BIGINT) AS "cust_id", CAST("cust_dob" AS TEXT) AS "cust_dob", CAST("cust_first_name" AS TEXT) AS "cust_first_name", CAST("cust_middle_name" AS TEXT) AS "cust_middle_name", CAST("cust_last_name" AS TEXT) AS "cust_last_name", CAST("cust_segment" AS TEXT) AS "cust_segment", CAST("cust_title" AS TEXT) AS "cust_title", CAST("customer_category" AS TEXT) AS "customer_category", CAST("customer_privelege" AS TEXT) AS "customer_privelege", CAST("customer_type" AS TEXT) AS "customer_type", CAST("email_addr" AS TEXT) AS "email_addr", CAST("gender" AS TEXT) AS "gender", CAST("minor_flag" AS TEXT) AS "minor_flag", CAST("mobile_number1" AS BIGINT) AS "mobile_number1", CAST("marital_status" AS TEXT) AS "marital_status", CAST("nationality" AS TEXT) AS "nationality", CAST("occupation" AS TEXT) AS "occupation", CAST("senior_citizen_flag" AS TEXT) AS "senior_citizen_flag", CAST("sourcing_channel" AS TEXT) AS "sourcing_channel", CAST("customer_status" AS TEXT) AS "customer_status", CAST("customer_risk_category" AS TEXT) AS "customer_risk_category", CAST("afflunce_level" AS TEXT) AS "afflunce_level", CAST("customer_addressline1" AS TEXT) AS "customer_addressline1", CAST("customer_addressline2" AS TEXT) AS "customer_addressline2", CAST("customer_addressline3" AS DOUBLE PRECISION) AS "customer_addressline3", CAST("city" AS TEXT) AS "city", CAST("state" AS TEXT) AS "state", CAST("country" AS TEXT) AS "country", CAST("pin" AS TEXT) AS "pin", CAST("created_at" AS TEXT) AS "created_at", CAST("modified_at" AS TEXT) AS "modified_at", CAST("cibil_check_date" AS TEXT) AS "cibil_check_date", CAST("cibil_score" AS BIGINT) AS "cibil_score", CAST("country_code" AS BIGINT) AS "country_code" FROM (VALUES "<REDACTED VALUES>") AS "t"("Unnamed: 0", "cust_id", "cust_dob", "cust_first_name", "cust_middle_name", "cust_last_name", "cust_segment", "cust_title", "customer_category", "customer_privelege", "customer_type", "email_addr", "gender", "minor_flag", "mobile_number1", "marital_status", "nationality", "occupation", "senior_citizen_flag", "sourcing_channel", "customer_status", "customer_risk_category", "afflunce_level", "customer_addressline1", "customer_addressline2", "customer_addressline3", "city", "state", "country", "pin", "created_at", "modified_at", "cibil_check_date", "cibil_score", "country_code") (base.py:2184)
2025-07-28 17:44:52,540 - ThreadPoolExecutor-2_3 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__enrich.enrich__product__332702689' (evaluator.py:1497)
2025-07-28 17:44:52,545 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__enrich"."enrich__product__332702689" ("type" TEXT, "name" TEXT, "currency_code" TEXT, "status" TEXT, "credit_interest_rate" DOUBLE PRECISION, "debit_interest_rate" DOUBLE PRECISION, "credit_line_amount" BIGINT, "created_at" TEXT, "modified_at" TEXT, "product_id" TEXT, "total_account" BIGINT, "total_customer" BIGINT, "total_active_account" BIGINT, "total_dormant_account" BIGINT, "total_balance" BIGINT) (base.py:2184)
2025-07-28 17:44:52,568 - ThreadPoolExecutor-2_3 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'enrich.product' (evaluator.py:1519)
2025-07-28 17:44:52,580 - ThreadPoolExecutor-2_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH "product_cte" AS (SELECT "product"."key" AS "type", "product"."name" AS "name", "product"."currency_code" AS "currency_code", "product"."status" AS "status", "product"."credit_interest_rate" AS "credit_interest_rate", "product"."debit_interest_rate" AS "debit_interest_rate", "product"."credit_line_amount" AS "credit_line_amount", "product"."created_at" AS "created_at", "product"."modified_at" AS "modified_at", "product"."id" AS "product_id" FROM "postgres"."sqlmesh__raw"."raw__product__3418704722" AS "product" WHERE FALSE), "total_account_per_product" AS (SELECT "account"."product_id" AS "product_id", COUNT(DISTINCT "account"."account_id") AS "total_account", COUNT("account"."primary_account_holder_id") AS "total_customer", COUNT("account"."account_id") FILTER(WHERE "account"."account_status" = 'Active') AS "total_active_account", COUNT("account"."account_id") FILTER(WHERE "account"."account_status" = 'Dormant') AS "total_dormant_account" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" WHERE FALSE GROUP BY "account"."product_id" ORDER BY "product_id"), "current_holding_ammount" AS (SELECT "account"."product_id" AS "product_id", SUM("account"."current_balance") AS "total_balance" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" WHERE FALSE GROUP BY "account"."product_id" ORDER BY "product_id") SELECT "pp"."type" AS "type", "pp"."name" AS "name", "pp"."currency_code" AS "currency_code", "pp"."status" AS "status", "pp"."credit_interest_rate" AS "credit_interest_rate", "pp"."debit_interest_rate" AS "debit_interest_rate", "pp"."credit_line_amount" AS "credit_line_amount", "pp"."created_at" AS "created_at", "pp"."modified_at" AS "modified_at", "pp"."product_id" AS "product_id", "tp"."total_account" AS "total_account", "tp"."total_customer" AS "total_customer", "tp"."total_active_account" AS "total_active_account", "tp"."total_dormant_account" AS "total_dormant_account", "ch"."total_balance" AS "total_balance" FROM "product_cte" AS "pp" LEFT JOIN "total_account_per_product" AS "tp" ON "pp"."product_id" = "tp"."product_id" LEFT JOIN "current_holding_ammount" AS "ch" ON "ch"."product_id" = "pp"."product_id" WHERE FALSE LIMIT 0 (base.py:2184)
2025-07-28 17:44:52,775 - ThreadPoolExecutor-3_1 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 00:00:00) for snapshot SnapshotId<"postgres"."raw"."customer": 2916775664> (facade.py:625)
2025-07-28 17:44:52,775 - ThreadPoolExecutor-3_1 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."raw"."customer": 2916775664> (interval.py:214)
2025-07-28 17:44:52,775 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 00:00:00) for snapshot SnapshotId<"postgres"."raw"."account": 3363262171> (facade.py:625)
2025-07-28 17:44:52,777 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."raw"."account": 3363262171> (interval.py:214)
2025-07-28 17:44:52,820 - ThreadPoolExecutor-3_3 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 00:00:00) for snapshot SnapshotId<"postgres"."raw"."transactions": 365872381> (facade.py:625)
2025-07-28 17:44:52,820 - ThreadPoolExecutor-3_3 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."raw"."transactions": 365872381> (interval.py:214)
2025-07-28 17:44:52,824 - ThreadPoolExecutor-3_2 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 00:00:00) for snapshot SnapshotId<"postgres"."raw"."product": 1420995480> (facade.py:625)
2025-07-28 17:44:52,824 - ThreadPoolExecutor-3_2 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."raw"."product": 1420995480> (interval.py:214)
2025-07-28 17:44:52,837 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"postgres"."enrich"."account": 2372665894> (evaluator.py:637)
2025-07-28 17:44:52,843 - ThreadPoolExecutor-3_2 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"postgres"."enrich"."product": 3294743817> (evaluator.py:637)
2025-07-28 17:44:52,856 - ThreadPoolExecutor-3_3 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"postgres"."enrich"."transactions": 2474979436> (evaluator.py:637)
2025-07-28 17:44:52,910 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-07-27 00:00:00, 2025-07-28 12:10:00) into postgres.sqlmesh__enrich.enrich__account__2754391612' (evaluator.py:691)
2025-07-28 17:44:52,913 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'enrich__account__2754391612' AND "table_schema" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:52,988 - ThreadPoolExecutor-3_2 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-07-27 00:00:00, 2025-07-28 12:10:00) into postgres.sqlmesh__enrich.enrich__product__332702689' (evaluator.py:691)
2025-07-28 17:44:52,999 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'enrich__product__332702689' AND "table_schema" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,000 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__enrich"."enrich__account__2754391612" WHERE TRUE (base.py:2184)
2025-07-28 17:44:53,005 - ThreadPoolExecutor-3_3 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-07-27 00:00:00, 2025-07-28 12:10:00) into postgres.sqlmesh__enrich.enrich__transactions__711840502' (evaluator.py:691)
2025-07-28 17:44:53,009 - ThreadPoolExecutor-3_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'enrich__transactions__711840502' AND "table_schema" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,012 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__enrich"."enrich__account__2754391612" ("account_id", "account_number", "product_id", "opening_date", "current_balance", "avg_monthly_balance", "avg_qtr_balance", "cust_id", "available_balance", "credit_card", "debit_card", "currency_code", "account_status", "source_channel", "campaign_id", "applied_interest_rate", "statement_date", "mode_of_statement") SELECT "account"."account_id" AS "account_id", "account"."account_number" AS "account_number", "account"."product_id" AS "product_id", "account"."account_origination_date" AS "opening_date", "account"."current_balance" AS "current_balance", "account"."avg_monthly_balance" AS "avg_monthly_balance", "account"."avg_qtr_balance" AS "avg_qtr_balance", "account"."primary_account_holder_id" AS "cust_id", "account"."available_balance" AS "available_balance", "account"."credit_card" AS "credit_card", "account"."debit_card" AS "debit_card", "account"."currency_code" AS "currency_code", "account"."account_status" AS "account_status", "account"."source_channel" AS "source_channel", "account"."campaign_id" AS "campaign_id", "account"."applied_interest_rate" AS "applied_interest_rate", "account"."statement_date" AS "statement_date", "account"."mode_of_statement" AS "mode_of_statement" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" (base.py:2184)
2025-07-28 17:44:53,013 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__enrich"."enrich__product__332702689" WHERE TRUE (base.py:2184)
2025-07-28 17:44:53,022 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__enrich"."enrich__product__332702689" ("type", "name", "currency_code", "status", "credit_interest_rate", "debit_interest_rate", "credit_line_amount", "created_at", "modified_at", "product_id", "total_account", "total_customer", "total_active_account", "total_dormant_account", "total_balance") WITH "product_cte" AS (SELECT "product"."key" AS "type", "product"."name" AS "name", "product"."currency_code" AS "currency_code", "product"."status" AS "status", "product"."credit_interest_rate" AS "credit_interest_rate", "product"."debit_interest_rate" AS "debit_interest_rate", "product"."credit_line_amount" AS "credit_line_amount", "product"."created_at" AS "created_at", "product"."modified_at" AS "modified_at", "product"."id" AS "product_id" FROM "postgres"."sqlmesh__raw"."raw__product__3418704722" AS "product"), "total_account_per_product" AS (SELECT "account"."product_id" AS "product_id", COUNT(DISTINCT "account"."account_id") AS "total_account", COUNT("account"."primary_account_holder_id") AS "total_customer", COUNT("account"."account_id") FILTER(WHERE "account"."account_status" = 'Active') AS "total_active_account", COUNT("account"."account_id") FILTER(WHERE "account"."account_status" = 'Dormant') AS "total_dormant_account" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" GROUP BY "account"."product_id" ORDER BY "product_id"), "current_holding_ammount" AS (SELECT "account"."product_id" AS "product_id", SUM("account"."current_balance") AS "total_balance" FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" GROUP BY "account"."product_id" ORDER BY "product_id") SELECT "pp"."type" AS "type", "pp"."name" AS "name", "pp"."currency_code" AS "currency_code", "pp"."status" AS "status", "pp"."credit_interest_rate" AS "credit_interest_rate", "pp"."debit_interest_rate" AS "debit_interest_rate", "pp"."credit_line_amount" AS "credit_line_amount", "pp"."created_at" AS "created_at", "pp"."modified_at" AS "modified_at", "pp"."product_id" AS "product_id", "tp"."total_account" AS "total_account", "tp"."total_customer" AS "total_customer", "tp"."total_active_account" AS "total_active_account", "tp"."total_dormant_account" AS "total_dormant_account", "ch"."total_balance" AS "total_balance" FROM "product_cte" AS "pp" LEFT JOIN "total_account_per_product" AS "tp" ON "pp"."product_id" = "tp"."product_id" LEFT JOIN "current_holding_ammount" AS "ch" ON "ch"."product_id" = "pp"."product_id" (base.py:2184)
2025-07-28 17:44:53,023 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"postgres"."enrich"."account": 2372665894> (evaluator.py:543)
2025-07-28 17:44:53,022 - ThreadPoolExecutor-3_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__enrich"."enrich__transactions__711840502" WHERE TRUE (base.py:2184)
2025-07-28 17:44:53,033 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__account__2754391612') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,036 - ThreadPoolExecutor-3_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__enrich"."enrich__transactions__711840502" ("Unnamed: 0", "cust_id", "account_id", "card_id", "transaction_id", "transaction_amnt", "mode_of_payment", "mcc_code", "transaction_time_stamp", "transaction_sign", "transaction_type", "swift_cd", "currency_cd", "transaction_status", "product_id", "channel_id", "count", "posting_date", "value_date", "notes", "reason_code", "created_at") SELECT "transactions"."Unnamed: 0" AS "Unnamed: 0", "transactions"."cust_id" AS "cust_id", "transactions"."account_id" AS "account_id", "transactions"."card_id" AS "card_id", "transactions"."transaction_id" AS "transaction_id", "transactions"."transaction_amnt" AS "transaction_amnt", "transactions"."mode_of_payment" AS "mode_of_payment", "transactions"."mcc_code" AS "mcc_code", "transactions"."transaction_time_stamp" AS "transaction_time_stamp", "transactions"."transaction_sign" AS "transaction_sign", "transactions"."transaction_type" AS "transaction_type", "transactions"."swift_cd" AS "swift_cd", "transactions"."currency_cd" AS "currency_cd", "transactions"."transaction_status" AS "transaction_status", "transactions"."product_id" AS "product_id", "transactions"."channel_id" AS "channel_id", "transactions"."count" AS "count", "transactions"."posting_date" AS "posting_date", "transactions"."value_date" AS "value_date", "transactions"."notes" AS "notes", "transactions"."reason_code" AS "reason_code", "transactions"."created_at" AS "created_at" FROM "postgres"."sqlmesh__raw"."raw__transactions__1169070496" AS "transactions" (base.py:2184)
2025-07-28 17:44:53,039 - ThreadPoolExecutor-3_2 - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"postgres"."enrich"."product": 3294743817> (evaluator.py:543)
2025-07-28 17:44:53,049 - ThreadPoolExecutor-3_3 - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"postgres"."enrich"."transactions": 2474979436> (evaluator.py:543)
2025-07-28 17:44:53,068 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__product__332702689') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,100 - ThreadPoolExecutor-3_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__transactions__711840502') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,112 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" WHERE NOT "account_status" IN ('Active', 'Dormant')) AS "audit" (base.py:2184)
2025-07-28 17:44:53,122 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__account__2754391612') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,155 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ("product_id") ORDER BY ("product_id") NULLS FIRST) AS "rank_" FROM "postgres"."sqlmesh__enrich"."enrich__product__332702689" AS "enrich__product__332702689" WHERE TRUE) AS "_q_0" WHERE "rank_" > 1) AS "audit" (base.py:2184)
2025-07-28 17:44:53,174 - ThreadPoolExecutor-3_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ("transaction_id") ORDER BY ("transaction_id") NULLS FIRST) AS "rank_" FROM "postgres"."sqlmesh__enrich"."enrich__transactions__711840502" AS "enrich__transactions__711840502" WHERE TRUE) AS "_q_0" WHERE "rank_" > 1) AS "audit" (base.py:2184)
2025-07-28 17:44:53,180 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY ("account_id") ORDER BY ("account_id") NULLS FIRST) AS "rank_" FROM "postgres"."sqlmesh__enrich"."enrich__account__2754391612" AS "enrich__account__2754391612" WHERE TRUE) AS "_q_0" WHERE "rank_" > 1) AS "audit" (base.py:2184)
2025-07-28 17:44:53,187 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__product__332702689') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,190 - ThreadPoolExecutor-3_3 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 12:10:00) for snapshot SnapshotId<"postgres"."enrich"."transactions": 2474979436> (facade.py:625)
2025-07-28 17:44:53,190 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 12:10:00) for snapshot SnapshotId<"postgres"."enrich"."account": 2372665894> (facade.py:625)
2025-07-28 17:44:53,190 - ThreadPoolExecutor-3_3 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."enrich"."transactions": 2474979436> (interval.py:214)
2025-07-28 17:44:53,196 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."enrich"."account": 2372665894> (interval.py:214)
2025-07-28 17:44:53,196 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" AS "account" WHERE NOT "account_status" IN ('Active', 'Dormant')) AS "audit" (base.py:2184)
2025-07-28 17:44:53,212 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'enrich__product__332702689') AND "nspname" = 'sqlmesh__enrich' (base.py:2184)
2025-07-28 17:44:53,224 - ThreadPoolExecutor-3_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "postgres"."sqlmesh__enrich"."enrich__product__332702689" AS "enrich__product__332702689" WHERE "product_id" IS NULL) AS "audit" (base.py:2184)
2025-07-28 17:44:53,229 - ThreadPoolExecutor-3_2 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-27 00:00:00, 2025-07-28 12:10:00) for snapshot SnapshotId<"postgres"."enrich"."product": 3294743817> (facade.py:625)
2025-07-28 17:44:53,229 - ThreadPoolExecutor-3_2 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."enrich"."product": 3294743817> (interval.py:214)
2025-07-28 17:44:53,283 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:173)
2025-07-28 17:44:53,316 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."raw"."transactions": 365872381> (snapshot.py:144)
2025-07-28 17:44:53,316 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."raw"."customer": 2916775664> (snapshot.py:144)
2025-07-28 17:44:53,316 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."raw"."account": 3363262171> (snapshot.py:144)
2025-07-28 17:44:53,316 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."enrich"."transactions": 2474979436> (snapshot.py:144)
2025-07-28 17:44:53,317 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."enrich"."product": 3294743817> (snapshot.py:144)
2025-07-28 17:44:53,317 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."enrich"."account": 2372665894> (snapshot.py:144)
2025-07-28 17:44:53,317 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."raw"."product": 1420995480> (snapshot.py:144)
2025-07-28 17:44:53,329 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.raw' (evaluator.py:1131)
2025-07-28 17:44:53,330 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "raw" (base.py:2184)
2025-07-28 17:44:53,335 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.enrich' (evaluator.py:1131)
2025-07-28 17:44:53,336 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "enrich" (base.py:2184)
2025-07-28 17:44:53,340 - ThreadPoolExecutor-5_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.raw.account' to point at table 'postgres.sqlmesh__raw.raw__account__3286186908' (evaluator.py:1452)
2025-07-28 17:44:53,341 - ThreadPoolExecutor-5_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.raw.product' to point at table 'postgres.sqlmesh__raw.raw__product__3418704722' (evaluator.py:1452)
2025-07-28 17:44:53,346 - ThreadPoolExecutor-5_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.raw.transactions' to point at table 'postgres.sqlmesh__raw.raw__transactions__1169070496' (evaluator.py:1452)
2025-07-28 17:44:53,349 - ThreadPoolExecutor-5_3 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.raw.customer' to point at table 'postgres.sqlmesh__raw.raw__customer__3869639198' (evaluator.py:1452)
2025-07-28 17:44:53,377 - ThreadPoolExecutor-5_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "raw"."account" CASCADE (base.py:2184)
2025-07-28 17:44:53,380 - ThreadPoolExecutor-5_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "raw"."account" AS SELECT * FROM "postgres"."sqlmesh__raw"."raw__account__3286186908" (base.py:2184)
2025-07-28 17:44:53,421 - ThreadPoolExecutor-5_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "raw"."product" CASCADE (base.py:2184)
2025-07-28 17:44:53,441 - ThreadPoolExecutor-5_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "raw"."transactions" CASCADE (base.py:2184)
2025-07-28 17:44:53,470 - ThreadPoolExecutor-5_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "raw"."customer" CASCADE (base.py:2184)
2025-07-28 17:44:53,472 - ThreadPoolExecutor-5_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "raw"."customer" AS SELECT * FROM "postgres"."sqlmesh__raw"."raw__customer__3869639198" (base.py:2184)
2025-07-28 17:44:53,472 - ThreadPoolExecutor-5_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "raw"."product" AS SELECT * FROM "postgres"."sqlmesh__raw"."raw__product__3418704722" (base.py:2184)
2025-07-28 17:44:53,473 - ThreadPoolExecutor-5_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "raw"."transactions" AS SELECT * FROM "postgres"."sqlmesh__raw"."raw__transactions__1169070496" (base.py:2184)
2025-07-28 17:44:53,481 - ThreadPoolExecutor-5_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.enrich.account' to point at table 'postgres.sqlmesh__enrich.enrich__account__2754391612' (evaluator.py:1452)
2025-07-28 17:44:53,483 - ThreadPoolExecutor-5_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "enrich"."account" CASCADE (base.py:2184)
2025-07-28 17:44:53,486 - ThreadPoolExecutor-5_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "enrich"."account" AS SELECT * FROM "postgres"."sqlmesh__enrich"."enrich__account__2754391612" (base.py:2184)
2025-07-28 17:44:53,509 - ThreadPoolExecutor-5_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.enrich.transactions' to point at table 'postgres.sqlmesh__enrich.enrich__transactions__711840502' (evaluator.py:1452)
2025-07-28 17:44:53,514 - ThreadPoolExecutor-5_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "enrich"."transactions" CASCADE (base.py:2184)
2025-07-28 17:44:53,520 - ThreadPoolExecutor-5_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.enrich.product' to point at table 'postgres.sqlmesh__enrich.enrich__product__332702689' (evaluator.py:1452)
2025-07-28 17:44:53,525 - ThreadPoolExecutor-5_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "enrich"."transactions" AS SELECT * FROM "postgres"."sqlmesh__enrich"."enrich__transactions__711840502" (base.py:2184)
2025-07-28 17:44:53,527 - ThreadPoolExecutor-5_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "enrich"."product" CASCADE (base.py:2184)
2025-07-28 17:44:53,532 - ThreadPoolExecutor-5_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "enrich"."product" AS SELECT * FROM "postgres"."sqlmesh__enrich"."enrich__product__332702689" (base.py:2184)
2025-07-28 17:44:53,556 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:139)
2025-07-28 17:44:53,580 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
